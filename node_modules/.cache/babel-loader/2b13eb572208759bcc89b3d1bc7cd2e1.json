{"ast":null,"code":"var bindEvents, buttonIsDown, coordsForTouchEvent, position;\n\ncoordsForTouchEvent = function (el, e) {\n  var p, tx, ty;\n  tx = e.changedTouches[0].clientX;\n  ty = e.changedTouches[0].clientY;\n  p = el.getBoundingClientRect();\n  return [tx - p.left, ty - p.top];\n};\n\nposition = function (el, e) {\n  var p;\n  p = el.getBoundingClientRect();\n  return {\n    left: e.clientX - p.left,\n    top: e.clientY - p.top\n  };\n};\n\nbuttonIsDown = function (e) {\n  if (e.buttons != null) {\n    return e.buttons === 1;\n  } else {\n    return e.which > 0;\n  }\n};\n\nmodule.exports = bindEvents = function (lc, canvas, panWithKeyboard) {\n  var listener, mouseMoveListener, mouseUpListener, touchEndListener, touchMoveListener, unsubs;\n\n  if (panWithKeyboard == null) {\n    panWithKeyboard = false;\n  }\n\n  unsubs = [];\n\n  mouseMoveListener = function (_this) {\n    return function (e) {\n      var p;\n      e.preventDefault();\n      p = position(canvas, e);\n      return lc.pointerMove(p.left, p.top);\n    };\n  }(this);\n\n  mouseUpListener = function (_this) {\n    return function (e) {\n      var p;\n      e.preventDefault();\n\n      canvas.onselectstart = function () {\n        return true;\n      };\n\n      p = position(canvas, e);\n      lc.pointerUp(p.left, p.top);\n      document.removeEventListener('mousemove', mouseMoveListener);\n      document.removeEventListener('mouseup', mouseUpListener);\n      return canvas.addEventListener('mousemove', mouseMoveListener);\n    };\n  }(this);\n\n  canvas.addEventListener('mousedown', function (_this) {\n    return function (e) {\n      var down, p;\n\n      if (e.target.tagName.toLowerCase() !== 'canvas') {\n        return;\n      }\n\n      down = true;\n      e.preventDefault();\n\n      canvas.onselectstart = function () {\n        return false;\n      };\n\n      p = position(canvas, e);\n      lc.pointerDown(p.left, p.top);\n      canvas.removeEventListener('mousemove', mouseMoveListener);\n      document.addEventListener('mousemove', mouseMoveListener);\n      return document.addEventListener('mouseup', mouseUpListener);\n    };\n  }(this));\n\n  touchMoveListener = function (e) {\n    e.preventDefault();\n    return lc.pointerMove.apply(lc, coordsForTouchEvent(canvas, e));\n  };\n\n  touchEndListener = function (e) {\n    e.preventDefault();\n    lc.pointerUp.apply(lc, coordsForTouchEvent(canvas, e));\n    document.removeEventListener('touchmove', touchMoveListener);\n    document.removeEventListener('touchend', touchEndListener);\n    return document.removeEventListener('touchcancel', touchEndListener);\n  };\n\n  canvas.addEventListener('touchstart', function (e) {\n    if (e.target.tagName.toLowerCase() !== 'canvas') {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (e.touches.length === 1) {\n      lc.pointerDown.apply(lc, coordsForTouchEvent(canvas, e));\n      document.addEventListener('touchmove', touchMoveListener);\n      document.addEventListener('touchend', touchEndListener);\n      return document.addEventListener('touchcancel', touchEndListener);\n    } else {\n      return lc.pointerMove.apply(lc, coordsForTouchEvent(canvas, e));\n    }\n  });\n\n  if (panWithKeyboard) {\n    console.warn(\"Keyboard panning is deprecated.\");\n\n    listener = function (e) {\n      switch (e.keyCode) {\n        case 37:\n          lc.pan(-10, 0);\n          break;\n\n        case 38:\n          lc.pan(0, -10);\n          break;\n\n        case 39:\n          lc.pan(10, 0);\n          break;\n\n        case 40:\n          lc.pan(0, 10);\n      }\n\n      return lc.repaintAllLayers();\n    };\n\n    document.addEventListener('keydown', listener);\n    unsubs.push(function () {\n      return document.removeEventListener(listener);\n    });\n  }\n\n  return function () {\n    var f, i, len, results;\n    results = [];\n\n    for (i = 0, len = unsubs.length; i < len; i++) {\n      f = unsubs[i];\n      results.push(f());\n    }\n\n    return results;\n  };\n};","map":{"version":3,"sources":["C:/Users/lukeq/blog/node_modules/literallycanvas/lib/js/core/bindEvents.js"],"names":["bindEvents","buttonIsDown","coordsForTouchEvent","position","el","e","p","tx","ty","changedTouches","clientX","clientY","getBoundingClientRect","left","top","buttons","which","module","exports","lc","canvas","panWithKeyboard","listener","mouseMoveListener","mouseUpListener","touchEndListener","touchMoveListener","unsubs","_this","preventDefault","pointerMove","onselectstart","pointerUp","document","removeEventListener","addEventListener","down","target","tagName","toLowerCase","pointerDown","apply","touches","length","console","warn","keyCode","pan","repaintAllLayers","push","f","i","len","results"],"mappings":"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","sourcesContent":["var bindEvents, buttonIsDown, coordsForTouchEvent, position;\n\ncoordsForTouchEvent = function(el, e) {\n  var p, tx, ty;\n  tx = e.changedTouches[0].clientX;\n  ty = e.changedTouches[0].clientY;\n  p = el.getBoundingClientRect();\n  return [tx - p.left, ty - p.top];\n};\n\nposition = function(el, e) {\n  var p;\n  p = el.getBoundingClientRect();\n  return {\n    left: e.clientX - p.left,\n    top: e.clientY - p.top\n  };\n};\n\nbuttonIsDown = function(e) {\n  if (e.buttons != null) {\n    return e.buttons === 1;\n  } else {\n    return e.which > 0;\n  }\n};\n\nmodule.exports = bindEvents = function(lc, canvas, panWithKeyboard) {\n  var listener, mouseMoveListener, mouseUpListener, touchEndListener, touchMoveListener, unsubs;\n  if (panWithKeyboard == null) {\n    panWithKeyboard = false;\n  }\n  unsubs = [];\n  mouseMoveListener = (function(_this) {\n    return function(e) {\n      var p;\n      e.preventDefault();\n      p = position(canvas, e);\n      return lc.pointerMove(p.left, p.top);\n    };\n  })(this);\n  mouseUpListener = (function(_this) {\n    return function(e) {\n      var p;\n      e.preventDefault();\n      canvas.onselectstart = function() {\n        return true;\n      };\n      p = position(canvas, e);\n      lc.pointerUp(p.left, p.top);\n      document.removeEventListener('mousemove', mouseMoveListener);\n      document.removeEventListener('mouseup', mouseUpListener);\n      return canvas.addEventListener('mousemove', mouseMoveListener);\n    };\n  })(this);\n  canvas.addEventListener('mousedown', (function(_this) {\n    return function(e) {\n      var down, p;\n      if (e.target.tagName.toLowerCase() !== 'canvas') {\n        return;\n      }\n      down = true;\n      e.preventDefault();\n      canvas.onselectstart = function() {\n        return false;\n      };\n      p = position(canvas, e);\n      lc.pointerDown(p.left, p.top);\n      canvas.removeEventListener('mousemove', mouseMoveListener);\n      document.addEventListener('mousemove', mouseMoveListener);\n      return document.addEventListener('mouseup', mouseUpListener);\n    };\n  })(this));\n  touchMoveListener = function(e) {\n    e.preventDefault();\n    return lc.pointerMove.apply(lc, coordsForTouchEvent(canvas, e));\n  };\n  touchEndListener = function(e) {\n    e.preventDefault();\n    lc.pointerUp.apply(lc, coordsForTouchEvent(canvas, e));\n    document.removeEventListener('touchmove', touchMoveListener);\n    document.removeEventListener('touchend', touchEndListener);\n    return document.removeEventListener('touchcancel', touchEndListener);\n  };\n  canvas.addEventListener('touchstart', function(e) {\n    if (e.target.tagName.toLowerCase() !== 'canvas') {\n      return;\n    }\n    e.preventDefault();\n    if (e.touches.length === 1) {\n      lc.pointerDown.apply(lc, coordsForTouchEvent(canvas, e));\n      document.addEventListener('touchmove', touchMoveListener);\n      document.addEventListener('touchend', touchEndListener);\n      return document.addEventListener('touchcancel', touchEndListener);\n    } else {\n      return lc.pointerMove.apply(lc, coordsForTouchEvent(canvas, e));\n    }\n  });\n  if (panWithKeyboard) {\n    console.warn(\"Keyboard panning is deprecated.\");\n    listener = function(e) {\n      switch (e.keyCode) {\n        case 37:\n          lc.pan(-10, 0);\n          break;\n        case 38:\n          lc.pan(0, -10);\n          break;\n        case 39:\n          lc.pan(10, 0);\n          break;\n        case 40:\n          lc.pan(0, 10);\n      }\n      return lc.repaintAllLayers();\n    };\n    document.addEventListener('keydown', listener);\n    unsubs.push(function() {\n      return document.removeEventListener(listener);\n    });\n  }\n  return function() {\n    var f, i, len, results;\n    results = [];\n    for (i = 0, len = unsubs.length; i < len; i++) {\n      f = unsubs[i];\n      results.push(f());\n    }\n    return results;\n  };\n};\n"]},"metadata":{},"sourceType":"script"}