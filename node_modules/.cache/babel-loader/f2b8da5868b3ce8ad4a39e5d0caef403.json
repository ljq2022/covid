{"ast":null,"code":"var AddShapeAction, ClearAction;\n\nClearAction = function () {\n  function ClearAction(lc1, oldShapes, newShapes1) {\n    this.lc = lc1;\n    this.oldShapes = oldShapes;\n    this.newShapes = newShapes1;\n  }\n\n  ClearAction.prototype[\"do\"] = function () {\n    this.lc.shapes = this.newShapes;\n    return this.lc.repaintLayer('main');\n  };\n\n  ClearAction.prototype.undo = function () {\n    this.lc.shapes = this.oldShapes;\n    return this.lc.repaintLayer('main');\n  };\n\n  return ClearAction;\n}();\n\nAddShapeAction = function () {\n  function AddShapeAction(lc1, shape1, previousShapeId) {\n    this.lc = lc1;\n    this.shape = shape1;\n    this.previousShapeId = previousShapeId != null ? previousShapeId : null;\n  }\n\n  AddShapeAction.prototype[\"do\"] = function () {\n    var found, i, len, newShapes, ref, shape;\n\n    if (!this.lc.shapes.length || this.lc.shapes[this.lc.shapes.length - 1].id === this.previousShapeId || this.previousShapeId === null) {\n      this.lc.shapes.push(this.shape);\n    } else {\n      newShapes = [];\n      found = false;\n      ref = this.lc.shapes;\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        shape = ref[i];\n        newShapes.push(shape);\n\n        if (shape.id === this.previousShapeId) {\n          newShapes.push(this.shape);\n          found = true;\n        }\n      }\n\n      if (!found) {\n        newShapes.push(this.shape);\n      }\n\n      this.lc.shapes = newShapes;\n    }\n\n    return this.lc.repaintLayer('main');\n  };\n\n  AddShapeAction.prototype.undo = function () {\n    var i, len, newShapes, ref, shape;\n\n    if (this.lc.shapes[this.lc.shapes.length - 1].id === this.shape.id) {\n      this.lc.shapes.pop();\n    } else {\n      newShapes = [];\n      ref = this.lc.shapes;\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        shape = ref[i];\n\n        if (shape.id !== this.shape.id) {\n          newShapes.push(shape);\n        }\n      }\n\n      lc.shapes = newShapes;\n    }\n\n    return this.lc.repaintLayer('main');\n  };\n\n  return AddShapeAction;\n}();\n\nmodule.exports = {\n  ClearAction: ClearAction,\n  AddShapeAction: AddShapeAction\n};","map":{"version":3,"sources":["C:/Users/lukeq/blog/node_modules/literallycanvas/lib/js/core/actions.js"],"names":["AddShapeAction","ClearAction","lc1","oldShapes","newShapes1","lc","newShapes","prototype","shapes","repaintLayer","undo","shape1","previousShapeId","shape","found","i","len","ref","length","id","push","pop","module","exports"],"mappings":"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","sourcesContent":["var AddShapeAction, ClearAction;\n\nClearAction = (function() {\n  function ClearAction(lc1, oldShapes, newShapes1) {\n    this.lc = lc1;\n    this.oldShapes = oldShapes;\n    this.newShapes = newShapes1;\n  }\n\n  ClearAction.prototype[\"do\"] = function() {\n    this.lc.shapes = this.newShapes;\n    return this.lc.repaintLayer('main');\n  };\n\n  ClearAction.prototype.undo = function() {\n    this.lc.shapes = this.oldShapes;\n    return this.lc.repaintLayer('main');\n  };\n\n  return ClearAction;\n\n})();\n\nAddShapeAction = (function() {\n  function AddShapeAction(lc1, shape1, previousShapeId) {\n    this.lc = lc1;\n    this.shape = shape1;\n    this.previousShapeId = previousShapeId != null ? previousShapeId : null;\n  }\n\n  AddShapeAction.prototype[\"do\"] = function() {\n    var found, i, len, newShapes, ref, shape;\n    if (!this.lc.shapes.length || this.lc.shapes[this.lc.shapes.length - 1].id === this.previousShapeId || this.previousShapeId === null) {\n      this.lc.shapes.push(this.shape);\n    } else {\n      newShapes = [];\n      found = false;\n      ref = this.lc.shapes;\n      for (i = 0, len = ref.length; i < len; i++) {\n        shape = ref[i];\n        newShapes.push(shape);\n        if (shape.id === this.previousShapeId) {\n          newShapes.push(this.shape);\n          found = true;\n        }\n      }\n      if (!found) {\n        newShapes.push(this.shape);\n      }\n      this.lc.shapes = newShapes;\n    }\n    return this.lc.repaintLayer('main');\n  };\n\n  AddShapeAction.prototype.undo = function() {\n    var i, len, newShapes, ref, shape;\n    if (this.lc.shapes[this.lc.shapes.length - 1].id === this.shape.id) {\n      this.lc.shapes.pop();\n    } else {\n      newShapes = [];\n      ref = this.lc.shapes;\n      for (i = 0, len = ref.length; i < len; i++) {\n        shape = ref[i];\n        if (shape.id !== this.shape.id) {\n          newShapes.push(shape);\n        }\n      }\n      lc.shapes = newShapes;\n    }\n    return this.lc.repaintLayer('main');\n  };\n\n  return AddShapeAction;\n\n})();\n\nmodule.exports = {\n  ClearAction: ClearAction,\n  AddShapeAction: AddShapeAction\n};\n"]},"metadata":{},"sourceType":"script"}