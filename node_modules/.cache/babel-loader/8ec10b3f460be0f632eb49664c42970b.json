{"ast":null,"code":"var SelectShape,\n    Tool,\n    createShape,\n    extend = function (child, parent) {\n  for (var key in parent) {\n    if (hasProp.call(parent, key)) child[key] = parent[key];\n  }\n\n  function ctor() {\n    this.constructor = child;\n  }\n\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n  child.__super__ = parent.prototype;\n  return child;\n},\n    hasProp = {}.hasOwnProperty;\n\nTool = require('./base').Tool;\ncreateShape = require('../core/shapes').createShape;\n\nmodule.exports = SelectShape = function (superClass) {\n  extend(SelectShape, superClass);\n  SelectShape.prototype.name = 'SelectShape';\n  SelectShape.prototype.usesSimpleAPI = false;\n\n  function SelectShape(lc) {\n    this.selectCanvas = document.createElement('canvas');\n    this.selectCanvas.style['background-color'] = 'transparent';\n    this.selectCtx = this.selectCanvas.getContext('2d');\n  }\n\n  SelectShape.prototype.didBecomeActive = function (lc) {\n    var onDown, onDrag, onUp, selectShapeUnsubscribeFuncs;\n    selectShapeUnsubscribeFuncs = [];\n\n    this._selectShapeUnsubscribe = function (_this) {\n      return function () {\n        var func, j, len, results;\n        results = [];\n\n        for (j = 0, len = selectShapeUnsubscribeFuncs.length; j < len; j++) {\n          func = selectShapeUnsubscribeFuncs[j];\n          results.push(func());\n        }\n\n        return results;\n      };\n    }(this);\n\n    onDown = function (_this) {\n      return function (arg) {\n        var br, shapeIndex, x, y;\n        x = arg.x, y = arg.y;\n        _this.didDrag = false;\n        shapeIndex = _this._getPixel(x, y, lc, _this.selectCtx);\n        _this.selectedShape = lc.shapes[shapeIndex];\n\n        if (_this.selectedShape != null) {\n          lc.trigger('shapeSelected', {\n            selectedShape: _this.selectedShape\n          });\n          lc.setShapesInProgress([_this.selectedShape, createShape('SelectionBox', {\n            shape: _this.selectedShape,\n            handleSize: 0\n          })]);\n          lc.repaintLayer('main');\n          br = _this.selectedShape.getBoundingRect();\n          return _this.dragOffset = {\n            x: x - br.x,\n            y: y - br.y\n          };\n        }\n      };\n    }(this);\n\n    onDrag = function (_this) {\n      return function (arg) {\n        var x, y;\n        x = arg.x, y = arg.y;\n\n        if (_this.selectedShape != null) {\n          _this.didDrag = true;\n\n          _this.selectedShape.setUpperLeft({\n            x: x - _this.dragOffset.x,\n            y: y - _this.dragOffset.y\n          });\n\n          lc.setShapesInProgress([_this.selectedShape, createShape('SelectionBox', {\n            shape: _this.selectedShape,\n            handleSize: 0\n          })]);\n          return lc.repaintLayer('main');\n        }\n      };\n    }(this);\n\n    onUp = function (_this) {\n      return function (arg) {\n        var x, y;\n        x = arg.x, y = arg.y;\n\n        if (_this.didDrag) {\n          _this.didDrag = false;\n          lc.trigger('shapeMoved', {\n            shape: _this.selectedShape\n          });\n          lc.trigger('drawingChange', {});\n          lc.repaintLayer('main');\n          return _this._drawSelectCanvas(lc);\n        }\n      };\n    }(this);\n\n    selectShapeUnsubscribeFuncs.push(lc.on('lc-pointerdown', onDown));\n    selectShapeUnsubscribeFuncs.push(lc.on('lc-pointerdrag', onDrag));\n    selectShapeUnsubscribeFuncs.push(lc.on('lc-pointerup', onUp));\n    return this._drawSelectCanvas(lc);\n  };\n\n  SelectShape.prototype.willBecomeInactive = function (lc) {\n    this._selectShapeUnsubscribe();\n\n    return lc.setShapesInProgress([]);\n  };\n\n  SelectShape.prototype._drawSelectCanvas = function (lc) {\n    var shapes;\n    this.selectCanvas.width = lc.canvas.width;\n    this.selectCanvas.height = lc.canvas.height;\n    this.selectCtx.clearRect(0, 0, this.selectCanvas.width, this.selectCanvas.height);\n    shapes = lc.shapes.map(function (_this) {\n      return function (shape, index) {\n        return createShape('SelectionBox', {\n          shape: shape,\n          handleSize: 0,\n          backgroundColor: \"#\" + _this._intToHex(index)\n        });\n      };\n    }(this));\n    return lc.draw(shapes, this.selectCtx);\n  };\n\n  SelectShape.prototype._intToHex = function (i) {\n    return (\"000000\" + i.toString(16)).slice(-6);\n  };\n\n  SelectShape.prototype._getPixel = function (x, y, lc, ctx) {\n    var p, pixel;\n    p = lc.drawingCoordsToClientCoords(x, y);\n    pixel = ctx.getImageData(p.x, p.y, 1, 1).data;\n\n    if (pixel[3]) {\n      return parseInt(this._rgbToHex(pixel[0], pixel[1], pixel[2]), 16);\n    } else {\n      return null;\n    }\n  };\n\n  SelectShape.prototype._componentToHex = function (c) {\n    var hex;\n    hex = c.toString(16);\n    return (\"0\" + hex).slice(-2);\n  };\n\n  SelectShape.prototype._rgbToHex = function (r, g, b) {\n    return \"\" + this._componentToHex(r) + this._componentToHex(g) + this._componentToHex(b);\n  };\n\n  return SelectShape;\n}(Tool);","map":{"version":3,"sources":["C:/Users/lukeq/blog/node_modules/literallycanvas/lib/js/tools/SelectShape.js"],"names":["SelectShape","Tool","createShape","extend","child","parent","key","hasProp","call","ctor","constructor","prototype","__super__","hasOwnProperty","require","module","exports","superClass","name","usesSimpleAPI","lc","selectCanvas","document","createElement","style","selectCtx","getContext","didBecomeActive","onDown","onDrag","onUp","selectShapeUnsubscribeFuncs","_selectShapeUnsubscribe","_this","func","j","len","results","length","push","arg","br","shapeIndex","x","y","didDrag","_getPixel","selectedShape","shapes","trigger","setShapesInProgress","shape","handleSize","repaintLayer","getBoundingRect","dragOffset","setUpperLeft","_drawSelectCanvas","on","willBecomeInactive","width","canvas","height","clearRect","map","index","backgroundColor","_intToHex","draw","i","toString","slice","ctx","p","pixel","drawingCoordsToClientCoords","getImageData","data","parseInt","_rgbToHex","_componentToHex","c","hex","r","g","b"],"mappings":"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","sourcesContent":["var SelectShape, Tool, createShape,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nTool = require('./base').Tool;\n\ncreateShape = require('../core/shapes').createShape;\n\nmodule.exports = SelectShape = (function(superClass) {\n  extend(SelectShape, superClass);\n\n  SelectShape.prototype.name = 'SelectShape';\n\n  SelectShape.prototype.usesSimpleAPI = false;\n\n  function SelectShape(lc) {\n    this.selectCanvas = document.createElement('canvas');\n    this.selectCanvas.style['background-color'] = 'transparent';\n    this.selectCtx = this.selectCanvas.getContext('2d');\n  }\n\n  SelectShape.prototype.didBecomeActive = function(lc) {\n    var onDown, onDrag, onUp, selectShapeUnsubscribeFuncs;\n    selectShapeUnsubscribeFuncs = [];\n    this._selectShapeUnsubscribe = (function(_this) {\n      return function() {\n        var func, j, len, results;\n        results = [];\n        for (j = 0, len = selectShapeUnsubscribeFuncs.length; j < len; j++) {\n          func = selectShapeUnsubscribeFuncs[j];\n          results.push(func());\n        }\n        return results;\n      };\n    })(this);\n    onDown = (function(_this) {\n      return function(arg) {\n        var br, shapeIndex, x, y;\n        x = arg.x, y = arg.y;\n        _this.didDrag = false;\n        shapeIndex = _this._getPixel(x, y, lc, _this.selectCtx);\n        _this.selectedShape = lc.shapes[shapeIndex];\n        if (_this.selectedShape != null) {\n          lc.trigger('shapeSelected', {\n            selectedShape: _this.selectedShape\n          });\n          lc.setShapesInProgress([\n            _this.selectedShape, createShape('SelectionBox', {\n              shape: _this.selectedShape,\n              handleSize: 0\n            })\n          ]);\n          lc.repaintLayer('main');\n          br = _this.selectedShape.getBoundingRect();\n          return _this.dragOffset = {\n            x: x - br.x,\n            y: y - br.y\n          };\n        }\n      };\n    })(this);\n    onDrag = (function(_this) {\n      return function(arg) {\n        var x, y;\n        x = arg.x, y = arg.y;\n        if (_this.selectedShape != null) {\n          _this.didDrag = true;\n          _this.selectedShape.setUpperLeft({\n            x: x - _this.dragOffset.x,\n            y: y - _this.dragOffset.y\n          });\n          lc.setShapesInProgress([\n            _this.selectedShape, createShape('SelectionBox', {\n              shape: _this.selectedShape,\n              handleSize: 0\n            })\n          ]);\n          return lc.repaintLayer('main');\n        }\n      };\n    })(this);\n    onUp = (function(_this) {\n      return function(arg) {\n        var x, y;\n        x = arg.x, y = arg.y;\n        if (_this.didDrag) {\n          _this.didDrag = false;\n          lc.trigger('shapeMoved', {\n            shape: _this.selectedShape\n          });\n          lc.trigger('drawingChange', {});\n          lc.repaintLayer('main');\n          return _this._drawSelectCanvas(lc);\n        }\n      };\n    })(this);\n    selectShapeUnsubscribeFuncs.push(lc.on('lc-pointerdown', onDown));\n    selectShapeUnsubscribeFuncs.push(lc.on('lc-pointerdrag', onDrag));\n    selectShapeUnsubscribeFuncs.push(lc.on('lc-pointerup', onUp));\n    return this._drawSelectCanvas(lc);\n  };\n\n  SelectShape.prototype.willBecomeInactive = function(lc) {\n    this._selectShapeUnsubscribe();\n    return lc.setShapesInProgress([]);\n  };\n\n  SelectShape.prototype._drawSelectCanvas = function(lc) {\n    var shapes;\n    this.selectCanvas.width = lc.canvas.width;\n    this.selectCanvas.height = lc.canvas.height;\n    this.selectCtx.clearRect(0, 0, this.selectCanvas.width, this.selectCanvas.height);\n    shapes = lc.shapes.map((function(_this) {\n      return function(shape, index) {\n        return createShape('SelectionBox', {\n          shape: shape,\n          handleSize: 0,\n          backgroundColor: \"#\" + (_this._intToHex(index))\n        });\n      };\n    })(this));\n    return lc.draw(shapes, this.selectCtx);\n  };\n\n  SelectShape.prototype._intToHex = function(i) {\n    return (\"000000\" + (i.toString(16))).slice(-6);\n  };\n\n  SelectShape.prototype._getPixel = function(x, y, lc, ctx) {\n    var p, pixel;\n    p = lc.drawingCoordsToClientCoords(x, y);\n    pixel = ctx.getImageData(p.x, p.y, 1, 1).data;\n    if (pixel[3]) {\n      return parseInt(this._rgbToHex(pixel[0], pixel[1], pixel[2]), 16);\n    } else {\n      return null;\n    }\n  };\n\n  SelectShape.prototype._componentToHex = function(c) {\n    var hex;\n    hex = c.toString(16);\n    return (\"0\" + hex).slice(-2);\n  };\n\n  SelectShape.prototype._rgbToHex = function(r, g, b) {\n    return \"\" + (this._componentToHex(r)) + (this._componentToHex(g)) + (this._componentToHex(b));\n  };\n\n  return SelectShape;\n\n})(Tool);\n"]},"metadata":{},"sourceType":"script"}